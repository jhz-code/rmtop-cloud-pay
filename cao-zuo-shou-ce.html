<!DOCTYPE html><html lang="en" data-theme="light"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>操作手册 - 支付sdk</title>
    
    
        <script src="asset/theme.js"></script>
    
<link rel="stylesheet" type="text/css" href="asset/plugins/theme-default/520.index.css"><style data-rh="true">
:root {
    --ttw-primary-color: #21ba45;
}
</style></head>
<body>
<div id="root"><div><div class="Loading__loading___1m_fZ"><div class="Loading__bar___21yOt" style="background: rgb(33, 186, 69); width: 0%; display: none;"><div class="Loading__peg___3Y_28"></div></div></div><div class="Loading__spinner___11Pm4"><div class="Loading__icon___3OOyu" style="display: none; border-color: #21ba45;"></div></div></div><div class="body--4cb30f26 with-sidebar--64a35dd2"><div class="sidebar--92cdcd4d"><div class="header--fbbaa9f2"><a class="title--8b08af4e" href="."><img src="logo.png" width="60" height="60" alt="logo">支付sdk</a><div class="search--783540ff"><input type="search" placeholder="请输入搜索关键词……" value=""></div></div><div class="body--4cb30f26"><div class="summary--54538abb"><ul><li class=""><div class="item--9cbf6482 active--c30e4dc0"><div class="whole--9f70f484"></div><span class="space--8603ccbf"></span><a class="text--59d9f9de" href="cao-zuo-shou-ce.html">操作手册</a></div></li></ul></div></div><div class="copyright--2aa57f2d">本文档使用 <a href="https://x.topthink.com" target="_blank">顶想云</a> 构建</div></div><div class="main--6aaec551"><div class="content--dbbad732"><article><h1>操作手册</h1><p>rmtop-cloud-pay<br>支付管理<br>云端支付sdk<br>安装<br>composer require rmtop/rmsf-cloud-pay</p><p>发布支付文件<br>php think rmtop:publish_pay</p><p>数据迁移 创建支付相关配置文件<br>php think migrate:run</p><p>支付配置操作<br>function addConfig(array $data) //创建配置</p><p>editConfig(int $id, array $data)<br>deleteConfig(int $id)</p><p>getConfig(int $id) //获取配置<br>微信支付配置<br>$data['merchantId'] = '15196xxxx';<br>$data['merchantSerialNumber'] = '6A6E499099E0F19FE334Cxxxxxxxx';<br>$data['apiV3key'] = 'xN5nxxxxxxxxx;<br>TopPayConfig::addConfig($data);</p><p>微信V3版相关支付<br>jsApi支付<br>$result =    TopWxPay::JsApi([<br>'configId'=&gt;'1',<br>'appid'=&gt;'wxc1ee20xxxxx',<br>'mchid'=&gt;'1519xxxxx',<br>'description'=&gt;'支持测试',<br>'out_trade_no'=&gt;time(),<br>'amount'=&gt;array('total'=&gt;100,'currency'=&gt;'CNY'),<br>'notify_url'=&gt;'<a href="http://127.0.0.1:8000/admin/">http://127.0.0.1:8000/admin/</a>',<br>'payer'=&gt;array('openid'=&gt;'oUpF8uMuAJO_M2pxb1Q9zNjWeS6o'),<br>]);</p><p>h5支付<br>$result =    TopWxPay::H5Api([<br>'configId'=&gt;'1',<br>'appid'=&gt;'wxxxxxxxxxx7',<br>'mchid'=&gt;'15196xxxxxx',<br>'description'=&gt;'支持测试',<br>'out_trade_no'=&gt;time(),<br>'amount'=&gt;array('total'=&gt;100,'currency'=&gt;'CNY'),<br>'notify_url'=&gt;'<a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>',<br>'scene_info'=&gt;array('payer_client_ip'=&gt;'http://127.0.0.1:8000/admin/','h5_info'=&gt;array('type'=&gt;'wap')),<br>]);<br>app支付<br>$result =    TopWxPay::AppApi([<br>'configId'=&gt;'1',<br>'appid'=&gt;'wxc1eexxxxxxxx',<br>'mchid'=&gt;'1519xxxxx',<br>'description'=&gt;'支持测试',<br>'out_trade_no'=&gt;time(),<br>'amount'=&gt;array('total'=&gt;100,'currency'=&gt;'CNY'),<br>'notify_url'=&gt;'http://127.0.0.1:8000/',<br>]);<br>Native 支付 二维码支付<br>$result =    TopWxPay::NativeApi([<br>'configId'=&gt;'1',<br>'appid'=&gt;'wxc1ee20xxxx',<br>'mchid'=&gt;'1519xxx',<br>'description'=&gt;'支持测试',<br>'out_trade_no'=&gt;time(),<br>'amount'=&gt;array('total'=&gt;100,'currency'=&gt;'CNY'),<br>'notify_url'=&gt;'http://127.0.0.1:8000/',<br>]);</p><p>查询订单<br>queryByTransactions(string $transaction_id,string $mchid)</p><p>queryByOrderId(string $orderId,string $mchid)<br>####关闭订单<br>closeOrder(string $orderId,string $mchid)<br>订单退款<br>queryRefundsOrder($out_refund_no)<br>####申请交易账单API<br>queryTradeBill(string $bill_date,string $bill_type = 'ALL',string $tar_type = '')<br>申请资金账单API<br>function fundFloBill(string $bill_date,string $account_type ='BASIC',string $tar_type='')<br>支付回调处理<br>如果能得到返回数据，则接受数据并验证成功，只需根据参数处理订单即可：<br>$result =  (new PayClient())-&gt;Notify(intput());<br>if($result['out_trade_no']){<br>//处理订单<br>}<br>exit(json(['code'=&gt;'SUCCESS','message'=&gt;'']));//通知微信支付网关</p><p>退款回调处理<br>$result =  (new PayClient())-&gt;Notify(intput());</p><p>$result 为退款回调通知数据<br>支付宝相关支付<br>开发中。。</p><div class="navigation--93943883"></div></article></div></div></div></div>
<script type="application/payload+json">
{"book":{"id":"43"},"summary":[{"title":"","articles":[{"title":"操作手册","ref":"操作手册.md","path":"cao-zuo-shou-ce.html","children":[]}]}],"config":{"title":"支付sdk"},"file":{"path":"cao-zuo-shou-ce.html","content":"rmtop-cloud-pay\n支付管理\n云端支付sdk \n安装 \ncomposer require rmtop\/rmsf-cloud-pay\n\n发布支付文件 \nphp think rmtop:publish_pay\n\n数据迁移 创建支付相关配置文件\nphp think migrate:run\n\n支付配置操作\nfunction addConfig(array $data) \/\/创建配置\n\neditConfig(int $id, array $data)\ndeleteConfig(int $id)\n\ngetConfig(int $id) \/\/获取配置\n微信支付配置\n$data['merchantId'] = '15196xxxx';\n$data['merchantSerialNumber'] = '6A6E499099E0F19FE334Cxxxxxxxx';\n$data['apiV3key'] = 'xN5nxxxxxxxxx;\nTopPayConfig::addConfig($data);\n\n微信V3版相关支付\njsApi支付 \n$result =    TopWxPay::JsApi([\n'configId'=>'1',\n'appid'=>'wxc1ee20xxxxx',\n'mchid'=>'1519xxxxx',\n'description'=>'支持测试',\n'out_trade_no'=>time(),\n'amount'=>array('total'=>100,'currency'=>'CNY'),\n'notify_url'=>'http:\/\/127.0.0.1:8000\/admin\/',\n'payer'=>array('openid'=>'oUpF8uMuAJO_M2pxb1Q9zNjWeS6o'),\n]);\n\nh5支付 \n$result =    TopWxPay::H5Api([\n'configId'=>'1',\n'appid'=>'wxxxxxxxxxx7',\n'mchid'=>'15196xxxxxx',\n'description'=>'支持测试',\n'out_trade_no'=>time(),\n'amount'=>array('total'=>100,'currency'=>'CNY'),\n'notify_url'=>'http:\/\/127.0.0.1:8000\/',\n'scene_info'=>array('payer_client_ip'=>'http:\/\/127.0.0.1:8000\/admin\/','h5_info'=>array('type'=>'wap')),\n]);\napp支付 \n$result =    TopWxPay::AppApi([\n'configId'=>'1',\n'appid'=>'wxc1eexxxxxxxx',\n'mchid'=>'1519xxxxx',\n'description'=>'支持测试',\n'out_trade_no'=>time(),\n'amount'=>array('total'=>100,'currency'=>'CNY'),\n'notify_url'=>'http:\/\/127.0.0.1:8000\/',\n]);\nNative 支付 二维码支付 \n$result =    TopWxPay::NativeApi([\n'configId'=>'1',\n'appid'=>'wxc1ee20xxxx',\n'mchid'=>'1519xxx',\n'description'=>'支持测试',\n'out_trade_no'=>time(),\n'amount'=>array('total'=>100,'currency'=>'CNY'),\n'notify_url'=>'http:\/\/127.0.0.1:8000\/',\n]);\n\n查询订单\nqueryByTransactions(string $transaction_id,string $mchid)\n\nqueryByOrderId(string $orderId,string $mchid)\n####关闭订单\ncloseOrder(string $orderId,string $mchid)\n订单退款\nqueryRefundsOrder($out_refund_no)\n####申请交易账单API\nqueryTradeBill(string $bill_date,string $bill_type = 'ALL',string $tar_type = '')\n申请资金账单API\nfunction fundFloBill(string $bill_date,string $account_type ='BASIC',string $tar_type='')\n支付回调处理\n如果能得到返回数据，则接受数据并验证成功，只需根据参数处理订单即可：\n$result =  (new PayClient())->Notify(intput());\nif($result['out_trade_no']){\n  \/\/处理订单\n}\nexit(json(['code'=>'SUCCESS','message'=>'']));\/\/通知微信支付网关\n\n退款回调处理\n$result =  (new PayClient())->Notify(intput());\n\n$result 为退款回调通知数据\n支付宝相关支付\n开发中。。","meta":{"mtime":"2021-06-17T15:34:00+08:00"}},"options":{}}
</script>

<script src="https://jsdelivr.topthink.com/npm/lodash@4.17/lodash.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react@17/umd/react.production.min.js"></script>

<script src="https://jsdelivr.topthink.com/npm/react-dom@17/umd/react-dom.production.min.js"></script>

<script src="asset/index.js"></script>

<script src="asset/plugins/theme-default/index.js"></script>

<script type="text/javascript">
    TopWrite.bootstrap();
</script>


</body></html>